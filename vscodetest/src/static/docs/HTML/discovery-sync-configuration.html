<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="MobileOptimized" content="width">
  <meta name="HandheldFriendly" content="true">
  <script type="text/javascript">
    var addThisScriptUrl = 'https://s7.addthis.com/js/300/addthis_widget.js';
  </script>
  <link rel='shortcut icon' href='../_webHelpImages/cloudbolt-login-logo.png' /><link rel='icon' href='../_webHelpImages/cloudbolt-login-logo.png' />
  <link rel='stylesheet' type='text/css' href='../_webHelpStyles/CHWebHelp.css?t=637806378603891771'/><link rel='stylesheet' type='text/css' href='../_webHelpStyles/CommonControls.css?t=637806378603891771'/><link rel='stylesheet' type='text/css' href='../_webHelpStyles/CommonControls/FontAwesome/css/font-awesome.min-ignore.css?t=637806378603891771'/><link rel='stylesheet' type='text/css' href='../_webHelpStyles/z-Branding.css?t=637806378603891771'/>
  <script  src='../_webHelpScripts/Master/1-script.js?t=637806378603891771' type='text/javascript'></script><script  src='../_webHelpScripts/Master/toc_nav.js?t=637806378603891771' type='text/javascript'></script>
  <link rel="stylesheet" href="https://cdn.materialdesignicons.com/5.0.45/css/materialdesignicons.min.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<script src="https://kit.fontawesome.com/68d03bdd6e.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
<script type="text/javascript">//<!--
appendEventHandler(window, 'load', function() {webHelpSelectTocNodeByExtId('discovery-sync-configuration',true);});
//--></script><title>Discovery/Sync Configuration</title><script type="text/javascript">//<!--
var articleTitleText='Discovery/Sync Configuration';
//--></script><link rel="stylesheet" type="text/css" href="../Styles/article-published.css"/><link rel="stylesheet" type="text/css" href="../Styles/cloudbolt-docs/CloudBoltBranding.css"/><script src="../Scripts/article-published.js" type="text/javascript"></script><script src="../Scripts/cloudbolt-docs/Script1.js" type="text/javascript"></script><script src="../Scripts/cloudbolt-docs/Script2.js" type="text/javascript"></script><meta charset="utf-8"><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  
</head>
<body class="WebHelp_body">
  <div id="pnlContainer" class="CHOffCanvasPanel_container">
    <div class="CHOffCanvasPanel_content">
      <nav id="pnlOffCanvasNav" class="CHOffCanvasPanel_nav noselect">
        <div id="pnlOffCanvasHeader" class="BaseMaster_offCanvasHeader">
        </div>
        <script  type='text/javascript'>//<!--
window['mobileMenu']=new CHMenu('pnlOffCanvasHeader',{"cssClasses":{"menu":null,"popup":null},"templates":{"itemContent":null,"treeItemContent":null,"dropDownArrow":null},"isMobileViewIfParentOverflow":false,"mobileViewMinWidthThreshold":-1,"selectedItemId":"tabContents","isAllowItemSelection":true,"isEscapeMenuItemText":true,"isUseFontAwesomeIcons":true,"fontAwesomeVersion":"4","isMovePopupToBodyChildLevel":true,"isShowPopupOnHover":false},[{"id":"menuItemMenu","t":"Menu","imgs":{},"c":[],"s":-1,"d":0,"e":0,"isNoFocus":false,"vals":{"_faIconCssClass":""}},{"id":"tabContents","t":"Topics","imgs":{},"c":[],"s":-1,"d":0,"e":0,"isNoFocus":false,"vals":{"_faIconCssClass":""}},{"id":"tabSearch","t":"Search","imgs":{},"c":[],"s":-1,"d":0,"e":0,"isNoFocus":false,"vals":{"_faIconCssClass":""}}]);window['mobileMenu'].onItemClick=function(s,e){webHelpMobileMenuItemClick(s,e);};
//--></script>
        <div id="pnlOffCanvasContent" class="BaseMaster_offCanvasContent">
        </div>        
      </nav>
      <div id="pnlOffCanvasOverlay" class="CHOffCanvasPanel_overlay"></div>
      <nav id="pnlMainMenuContainer" class="BaseMaster_mainMenuContainer">
        <button type="button" aria-label="Show mobile menu" title="Show mobile menu" id="btnMobileMenu" style="display:none"
          class="CHHamburger_container CHHamburger_container-htla BaseMaster_hamburgerMenuIcon">
          <span></span>
        </button>
        <a title='CloudBolt Software' href='https://cloudbolt.io' target='_blank'><img alt='CloudBolt Software' class='BaseMaster_imgLogo' src='../_webHelpImages/cloudbolt_line_transparent_white_FINAL.png' /></a>
        <div id="pnlMainMenu" class="BaseMaster_pnlMainMenu"></div>
        <script  type='text/javascript'>//<!--
window['mainMenu']=new CHMenu('pnlMainMenu',{"cssClasses":{"menu":null,"popup":null},"templates":{"itemContent":null,"treeItemContent":null,"dropDownArrow":null},"isMobileViewIfParentOverflow":true,"mobileViewMinWidthThreshold":979,"selectedItemId":null,"isAllowItemSelection":false,"isEscapeMenuItemText":true,"isUseFontAwesomeIcons":true,"fontAwesomeVersion":"4","isMovePopupToBodyChildLevel":true,"isShowPopupOnHover":false},[{"id":"926ab37c-af98-eab8-2cb6-f0224c32b59e","t":"Getting Support","imgs":{},"c":[],"s":0,"d":0,"e":1,"isNoFocus":false,"vals":{"actionType":"OpenLink","_customCssClass":null,"_url":"https://support.cloudbolt.io/","_target":"_blank"}},{"id":"a93dc193-cfa0-0c55-dc87-ef748c016d3e","t":"CloudBolt API","imgs":{},"c":[],"s":0,"d":0,"e":1,"isNoFocus":false,"vals":{"actionType":"OpenArticle","_customCssClass":null,"_url":"http://docs.cloudbolt.io/articles/cloudbolt-latest-docs/cloudbolt-api-v3","_target":"_blank"}},{"id":"1d7d67de-8445-1336-084c-3d22cc440080","t":"Documentation Portal","imgs":{},"c":[],"s":0,"d":0,"e":1,"isNoFocus":false,"vals":{"actionType":"OpenLink","_customCssClass":null,"_url":"https://docs.cloudbolt.io/"}},{"id":"d4ac0703-4b0e-d846-4521-45b57775c8f2","t":"Knowledge Base","imgs":{},"c":[],"s":0,"d":0,"e":1,"isNoFocus":false,"vals":{"actionType":"OpenLink","_customCssClass":null,"_url":"https://support.cloudbolt.io/hc/en-us/sections/201319545-Knowledge-Base","_target":"_blank"}}]);window['mainMenu'].onViewSwitched=function(s,e){webHelpMasterPageMainMenuViewSwitched(s,e);};
//--></script>
        <div class="WebHelp_searchBoxContainer">
          <input id="edtSearch" type="search" class="WebHelp_searchBox" aria-label="Search" />
          <button id="btnSearch" class="btnSearch" alt="Search" title="Search" aria-label="Search" href="javascript:void(0)"></button>
        </div>
      </nav>
      <div id="pnlContentContainer" class="BaseMaster_contentContainer clearfix">
        <nav id="pnlArticlesNav" class="WebHelp_navPanel">
          <div id="pnlNavTabs" class="WebHelp_navMenu"></div>
          <script  type='text/javascript'>//<!--
window['navMenu']=new CHMenu('pnlNavTabs',{"cssClasses":{"menu":null,"popup":null},"templates":{"itemContent":null,"treeItemContent":null,"dropDownArrow":null},"isMobileViewIfParentOverflow":false,"mobileViewMinWidthThreshold":-1,"selectedItemId":"tabContents","isAllowItemSelection":true,"isEscapeMenuItemText":true,"isUseFontAwesomeIcons":true,"fontAwesomeVersion":"4","isMovePopupToBodyChildLevel":true,"isShowPopupOnHover":false},[{"id":"tabContents","t":"Topics","imgs":{},"c":[],"s":-1,"d":0,"e":0,"isNoFocus":false,"vals":{"_faIconCssClass":""}},{"id":"tabSearch","t":"Search","imgs":{},"c":[],"s":-1,"d":0,"e":0,"isNoFocus":false,"vals":{"_faIconCssClass":""}}]);window['navMenu'].onItemClick=function(s,e){webHelpNavMenuItemClick(s,e);};
//--></script>
          <div id="pnlTocContainer" class="WebHelp_navPanelContent ArticleSelector_tabContent TocTreeLight_container">
            <div id="pnlToc"></div>
          </div>
          <div id="pnlIndex" class="WebHelp_navPanelContent ArticleSelector_tabContent" style="display:none">
            <iframe id="frameIndex" style="height: 100%; width:100%; display:block;" frameborder="0"></iframe>
          </div>
          <div id="pnlSearch" class="WebHelp_navPanelContent ArticleSelector_tabContent" style="display:none">
            <iframe id="frameSearch" style="height: 100%; width:100%; display: block;" frameborder="0"></iframe>
          </div>
        </nav>
        <article class="TopicViewer_container">
          <header id="pnlTopicHeader" class="TopicViewer_header"  style='display:none'>
            <div id="pnlSocial" class="TopicViewer_headerShare">Share: </div>
            <div class="TopicViewer_headerText">
              <div class="ArticleEditor_projectName">cloudbolt_docs</div>
              <strong id="pnlTitle" class="ArticleEditor_title">Discovery/Sync Configuration</strong>
              <button type="button" id="btnPrint" class="CHImageButton ArticleEditor_imageButton ArticleEditor_fontAwesomeButton ArticleEditor_btnPrint" title="Print this topic">
                <i class="fa fa-print"></i>
              </button>
            </div>
          </header>
          <div id="pnlTopicContentContainer" class="TopicViewer_contentContainer">
            <!-- START ARTICLE CONTAINER -->
<div class="container">
  <div class="articleBreadcrumb">
    <span class="CHBreadcrumb"><span class="CHBreadcrumb_item CHBreadcrumb_itemHome"><a href="/" target="_top">Home</a></span><span class="CHBreadcrumb_separator">›</span><span class="CHBreadcrumb_item">Using CloudBolt</span><span class="CHBreadcrumb_separator">›</span><span class="CHBreadcrumb_item"><a href="blueprints.html">Blueprints</a></span><span class="CHBreadcrumb_separator">›</span><span class="CHBreadcrumb_item CHBreadcrumb_itemSelf">Discovery/Sync Configuration</span></span>
  </div><p>
</p>
<h1 id="h1__326193880" data-has-heading-anchor="true">
  Discovery/Sync Configuration
<a href="discovery-sync-configuration.html#h1__326193880" class="CHHeadingLink" title="Link to this heading" aria-hidden="true"></a></h1>
<p>
  A Blueprint can be configured to discover and sync resources of the type that it describes. This can be especially useful for bringing brownfield environments under management.
</p>
<p>
  The main component of configuring the discovery/ sync logic for a Blueprint is the Discovery Plug-in. You can also choose whether any existing Resource associated with the Blueprint should be&nbsp;<a href="syncing-resources.html#automatically-marking-resources-historical">automatically marked Historical</a>&nbsp;if it is not found by the Discovery Plug-in when it runs. Note that the&nbsp;“Sync Resources” Recurring Job&nbsp;must be enabled for this feature to be used.
</p>
<table class="infoBox" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td class="infoBoxImageCell">
        <img alt="Information" src="../Storage/cloudbolt-docs/info.png"/><span style="font-family: Arial, &quot;Helvetica Neue&quot;, Helvetica, sans-serif;">
        </span>
      </td>
      <td>
        
          Because only CloudBolt Admins can create or edit CloudBolt Plug-ins, a Blueprint manager who is not an Admin will only be able to select an existing shared plug-in to set as a Discovery Plug-in.&nbsp;
      </td>
    </tr>
  </tbody>
</table>
<h2 id="h2__1104935284" data-children-count="1" data-has-heading-anchor="true">
  <span id="writing-discovery-plugin"></span>Writing a Discovery Plug-in
<a href="discovery-sync-configuration.html#h2__1104935284" class="CHHeadingLink" title="Link to this heading" aria-hidden="true"></a></h2>
<p>
  Some of the details of your Discovery Plug-in will certainly vary based on its purpose and the external system that it connects to, but some of the structure is prescribed.
</p>
<p>
  Planning:
</p>
<ul>
  <li>
    For the type of Resources you want to discover and sync, determine which of their attributes should be used to uniquely identify them. Note that this identifier only needs to be unique across Resources associated with this particular Blueprint.
  </li>
  <li>
    Then, determine all the other attributes you would like to store about them, including what type of value each has.
  </li>
  <li>
    Consider permissions, namely what Group should own the discovered Resources and who their owner should be, if anyone.
  </li>
</ul>
<p>
  Requirements:
</p>
<ul>
  <li>
    The plug-in must have a global variable RESOURCE_IDENTIFIER defined, whose value is either a string or an iterable collection of strings, matching the key(s) in the discovered dictionaries whose value(s) will be used to uniquely identify Resources (within the Resources associated with that Blueprint).
  </li>
  <li>
    The plug-in must contain a method called discover_resources that returns a list of dictionaries, where each dictionary represents a discovered resource.
  </li>
  <li>
    All keys in those dictionaries should map to attributes that can be set on a Resource object. This includes Resource model fields and Parameters (using their name as the key). If a key does not match a field or current Parameter, a new Parameter will be created with that name. The label will be derived from the name. If the value for that key is an integer, decimal/ float, datetime object, or boolean, the Parameter will be of that type; otherwise, it will default to a string type. If the type created is not what you intended, delete that Parameter and create a new one that matches your needs. All other Parameter attributes will be set to their defaults.
  </li>
</ul>
<p>
  Special cases for setting attributes:
</p>
<ul>
  <li>
    Some Resource model fields are always set by CloudBolt, and will be ignored if they are included in a discovered dictionary. These include the Blueprint the Resource is associated with (always the one with the Discovery Plug-in), the Resource Type (always the one associated with the Blueprint), and the jobs associated with the Resource.
  </li>
  <li>
    Some Resource model fields can be provided by the discovered dictionary, but will be set to default values if they are not. If no Group is provided, the “Unassigned” Group will be used. If a name is not provided, the value of the first resource identifier from the dictionary will be used. If all identifying attributes should be used in naming a new resource, or if there are any other naming conventions, we strongly suggest that a ‘name’ attribute be passed as part of the discovered dictionary. If no valid value is provided for the lifecycle or a created date &amp; time, they will default to Active and the current time, respectively.
  </li>
  <li>
    If you wish to set either the owner or group of the Resource, find and return a UserProfile or Group object, respectively, in the discovered dictionary.
  </li>
  <li>
    Whenever an invalid value is provided to an attribute, it will not be set. This includes everything from the wrong type of value for a Parameter to an incorrectly-formatted DateTime for the created field to something that is not actually a Group object. The values in the discovered dictionary should be the desired type.
  </li>
</ul>
<p>
  Below is a skeleton example of a possible Discovery Plug-in:
</p>
<p data-children-count="1">
  <table class="CHCodeSample_container notranslate" cellspacing="0" cellpadding="0"><tr class="CHCodeSample_tr1"><td class="CHCodeSample_header"><div class="CHCodeSample_copyCode nonPrintable"><a onclick="copyCodeSample(this)" href="javascript:void(0)">Copy Code</a></div><div class="CHCodeSample_langName notranslate">Python</div></td></tr><tr class="CHCodeSample_tr2"><td class="CHCodeSample_code notranslate cm-s-default"><pre><span class="cm-keyword">from</span> <span class="cm-variable">datetime</span> <span class="cm-keyword">import</span> <span class="cm-variable">datetime</span><br><br><span class="cm-variable">RESOURCE_IDENTIFIER</span> = <span class="cm-string">'my_id_key'</span><br><br><span class="cm-keyword">def</span> <span class="cm-variable">discover_resources</span>(<span class="cm-operator">*</span><span class="cm-variable">args</span>, <span class="cm-operator">**</span><span class="cm-variable">kwargs</span>):<br>  <span class="cm-variable">objects_from_system</span> = <span class="cm-operator">&lt;</span><span class="cm-variable">reach</span> <span class="cm-variable">out</span> <span class="cm-variable">to</span> <span class="cm-variable">external</span> <span class="cm-variable">system</span> <span class="cm-variable">here</span><span class="cm-operator">&gt;</span><br>  <span class="cm-variable">owner</span> = <span class="cm-variable">UserProfile</span><span class="cm-variable">.objects</span><span class="cm-variable">.get</span>(<span class="cm-variable">user__username</span>=<span class="cm-string">'my username'</span>)<br>  <span class="cm-variable">group</span> = <span class="cm-variable">Group</span><span class="cm-variable">.objects</span><span class="cm-variable">.get</span>(<span class="cm-variable">name</span>=<span class="cm-string">'my group name'</span>)<br><br>  <span class="cm-variable">dictionaries</span> = []<br>  <span class="cm-keyword">for</span> <span class="cm-variable">object_from_system</span> <span class="cm-operator">in</span> <span class="cm-variable">objects_from_system</span>:<br>    <span class="cm-variable">dictionaries</span><span class="cm-variable">.append</span>({<br>      <span class="cm-string">'name'</span>: <span class="cm-variable">object_from_system</span><span class="cm-variable">.name</span>,<br>      <span class="cm-string">'my_id_key'</span>: <span class="cm-variable">object_from_system</span><span class="cm-variable">.uuid</span>,<br>      <span class="cm-string">'owner'</span>: <span class="cm-variable">owner</span>,<br>      <span class="cm-string">'group'</span>: <span class="cm-variable">group</span>,<br>      <span class="cm-string">'some_attribute'</span>: <span class="cm-variable">object_from_system</span><span class="cm-variable">.some_attribute</span>,<br>      <span class="cm-comment"># To create the Parameter as a Date &amp; Time type, the value should</span><br>      <span class="cm-comment"># be a datetime object</span><br>      <span class="cm-string">'last_synced'</span>: <span class="cm-variable">datetime</span><span class="cm-variable">.now</span>(),<br>      <span class="cm-comment"># To create the Parameter as a Boolean type, the value should</span><br>      <span class="cm-comment"># be a boolean constant object</span><br>      <span class="cm-string">'synced_from_system'</span>: <span class="cm-builtin">True</span>,<br>   })<br><span class="cm-error"> </span><span class="cm-keyword">return</span> <span class="cm-variable">dictionaries</span></pre></td></tr></table>
  <br/>
</p>
<div>
  <br/>
</div>  <div class="articleActions row pt-4 mt-5 mb-4 ml-0">
    <div class="col-6">
      <span class="CHNavCaption">Previous Topic</span><a href="resource-names.html" class="articleActions_link CHNavLinkPrevious">Resource Names</a>
    </div>
    <div class="col-6 text-right">
      <span class="CHNavCaption">Next Topic</span><a href="blueprint-actions.html" class="articleActions_link CHNavLinkNext">Blueprint Actions</a>
    </div>
  </div>
</div>
<!-- END ARTICLE CONTAINER -->
<!-- FOOTER -->
<div class="footer">
  <div class="footerInner">
    <div class="container">
      <div class="row">
        <div class="col-6">
          <div class="row">
            <div class="col-12">
              <a href="https://www.cloudbolt.io/" target="_blank">
                <img src="../Storage/cloudbolt-docs/logos/cb-horizontal-white.svg" class="img-fluid footerLogo" alt="CloudBolt"/>
              </a>
            </div>
          </div>
          <div class="row mt-4">
            <div class="col-12">
              <a class="btn btn-social" href="mailto:support@cloudbolt.io" role="button" target="_top">
                <span class="btn-icon"><i class="mdi mdi-face-agent"></i></span>
                support@cloudbolt.io
              </a>
            </div>
          </div>
        </div>
        <div class="col-6">
          <p class="footerTitle">
            About the Company
          </p>
          <p class="footerAbout" data-children-count="1">
            CloudBolt&#39;s hybrid cloud platform for enterprises helps IT admins provide simple to very complex IT resources to end users from a single portal.
          </p>
          <ul class="socials">
            <li class="mr-3">
              <a class="social-link" href="https://www.facebook.com/CloudBoltSoftware/" target="_blank" title="Facebook">
                <i class="mdi mdi-facebook"></i>
              </a>
            </li>
            <li class="mr-3">
              <a class="social-link" href="https://twitter.com/CloudBoltSW" target="_blank" title="Twitter">
                <i class="mdi mdi-twitter"></i>
              </a>
            </li>
            <li class="mr-3">
              <a class="social-link" href="https://www.linkedin.com/company/cloudbolt/" target="_blank" title="LinkedIn">
                <i class="mdi mdi-linkedin"></i>
              </a>
            </li>
            <li>
              <a class="social-link" href="https://github.com/CloudBoltSoftware/cloudbolt-forge" target="_blank" title="GitHub">
                <i class="mdi mdi-github"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div class="row mt-4">
        <div class="col-12 text-center">
          <span class="copyright mt-5" data-children-count="1">© CloudBolt Software. All rights reserved</span>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  if (window['initFooter']) {
    initFooter();
  }
</script>
<!-- SCRIPTS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="../Scripts/project-cloudbolt-docs/lightbox-plus-jquery.min.js"></script>
          </div>
        </article>
      </div>
    </div>
  </div>  
</body>
</html>
